<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Chicken Crossing</title>
  <style>
    body {
      margin: 0;
      background: #222;
      color: #fff;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    canvas {
      background: #444;
      border: 3px solid #fff;
      margin-top: 20px;
    }

    h1 {
      margin-top: 20px;
    }

    #score {
      font-size: 24px;
      margin: 10px;
    }

    #game-over {
      font-size: 32px;
      color: red;
      display: none;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>🐔 Chicken Crossing</h1>
  <div id="score">💰 Geld: 0</div>
  <canvas id="gameCanvas" width="400" height="500"></canvas>
  <div id="game-over">💥 Game Over!</div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreDisplay = document.getElementById("score");
    const gameOverDisplay = document.getElementById("game-over");

    const ROWS = 10;
    const COLS = 8;
    const TILE_SIZE = 50;
    const WIDTH = COLS * TILE_SIZE;
    const HEIGHT = ROWS * TILE_SIZE;

    const chicken = {
      x: Math.floor(COLS / 2),
      y: ROWS - 1,
      color: "yellow"
    };

    let cars = [];
    let score = 0;
    let gameOver = false;

    function drawTile(x, y, color) {
      ctx.fillStyle = color;
      ctx.fillRect(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE - 2, TILE_SIZE - 2);
    }

    function drawChicken() {
      drawTile(chicken.x, chicken.y, chicken.color);
    }

    function spawnCar(row, direction) {
      const car = {
        y: row,
        x: direction === "right" ? -1 : COLS,
        dir: direction,
        speed: 0.05 + Math.random() * 0.03,
        color: "red"
      };
      cars.push(car);
    }

    function updateCars(delta) {
      for (let car of cars) {
        if (car.dir === "right") {
          car.x += car.speed * delta;
        } else {
          car.x -= car.speed * delta;
        }
      }

      cars = cars.filter(car => car.x > -2 && car.x < COLS + 2);
    }

    function drawCars() {
      for (let car of cars) {
        drawTile(Math.floor(car.x), car.y, car.color);
      }
    }

    function checkCollision() {
      for (let car of cars) {
        if (Math.floor(car.x) === chicken.x && car.y === chicken.y) {
          gameOver = true;
          gameOverDisplay.style.display = "block";
        }
      }
    }

    function gameLoop(timestamp) {
      if (lastTime === null) lastTime = timestamp;
      const delta = timestamp - lastTime;
      lastTime = timestamp;

      ctx.clearRect(0, 0, WIDTH, HEIGHT);

      updateCars(delta);
      drawCars();
      drawChicken();
      checkCollision();

      if (!gameOver) {
        requestAnimationFrame(gameLoop);
      }
    }

    function randomizeTraffic() {
      for (let i = 1; i < ROWS - 1; i++) {
        if (Math.random() < 0.02) {
          const dir = Math.random() < 0.5 ? "left" : "right";
          spawnCar(i, dir);
        }
      }
    }

    document.addEventListener("keydown", e => {
      if (e.code === "Space" && !gameOver) {
        if (chicken.y > 0) {
          chicken.y -= 1;
          score += 10;
          scoreDisplay.textContent = `💰 Geld: ${score}`;
        }
      }
    });

    let lastTime = null;
    setInterval(randomizeTraffic, 300);

    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
