<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Chicken Road - Seitw√§rts</title>
  <style>
    body {
      background: #222;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
    }
    canvas {
      background: #333;
      border: 3px solid white;
      margin-top: 20px;
    }
    #score {
      font-size: 24px;
      margin-top: 10px;
    }
    #game-over {
      font-size: 32px;
      color: red;
      display: none;
      margin-top: 20px;
    }
    #game-won {
      font-size: 32px;
      color: lime;
      display: none;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>üêî Chicken Crossing ‚Äì Seitw√§rts</h1>
  <div id="score">üí∞ Geld: 0</div>
  <canvas id="game" width="1000" height="100"></canvas>
  <div id="game-over">üí• GAME OVER</div>
  <div id="game-won">üéâ GESCHAFFT!</div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    const TILE_SIZE = 50;
    const COLUMNS = 20;
    const ROWS = 1;

    const chicken = {
      x: 0,
      y: 0,
      color: 'yellow'
    };

    let cars = []; // Autos mit animierter Bewegung
    let score = 0;
    let gameOver = false;
    let gameWon = false;

    function drawTile(x, y, color) {
      ctx.fillStyle = color;
      ctx.fillRect(x * TILE_SIZE + 2, y * TILE_SIZE + 2, TILE_SIZE - 4, TILE_SIZE - 4);
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Autos zeichnen
      for (let car of cars) {
        drawTile(car.x, car.y, 'red');
      }

      // Huhn zeichnen
      drawTile(chicken.x, chicken.y, chicken.color);
    }

    function update(deltaTime) {
      // Autos bewegen
      for (let car of cars) {
        car.x += car.speed * deltaTime;
      }

      // Entferne Autos, die rechts rausfahren
      cars = cars.filter(car => car.x < COLUMNS);

      // Kollision pr√ºfen
      for (let car of cars) {
        if (Math.floor(car.x) === chicken.x && car.y === chicken.y) {
          gameOver = true;
          document.getElementById("game-over").style.display = "block";
        }
      }
    }

    function spawnCarAhead() {
      const chance = Math.random() < 0.5;
      if (!chance) return;

      const car = {
        x: -1, // Start links au√üerhalb
        y: 0,
        speed: 0.01 + Math.random() * 0.02
      };

      cars.push(car);
    }

    function stepForward() {
      if (gameOver || gameWon) return;

      const nextX = chicken.x + 1;

      if (nextX >= COLUMNS) {
        gameWon = true;
        document.getElementById("game-won").style.display = "block";
        return;
      }

      chicken.x = nextX;
      score += 10;
      document.getElementById("score").textContent = `üí∞ Geld: ${score}`;

      spawnCarAhead(); // 50/50 Auto auf dem neuen Feld

      draw();
    }

    document.addEventListener("keydown", (e) => {
      if (e.code === "Space") {
        stepForward();
      }
    });

    // Spiel-Loop
    let lastTime = null;
    function gameLoop(timestamp) {
      if (lastTime === null) lastTime = timestamp;
      const delta = timestamp - lastTime;
      lastTime = timestamp;

      if (!gameOver && !gameWon) {
        update(delta);
        draw();
        requestAnimationFrame(gameLoop);
      } else {
        draw(); // Letzter Stand zeigen
      }
    }

    draw();
    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
